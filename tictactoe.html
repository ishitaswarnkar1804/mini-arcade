<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic Tac Toe | Mini Arcade</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<header class="topbar">
<div class="brand">
<div class="logo">MA</div>
<div class="title">
<h1>Mini Arcade</h1>
<p>Tic Tac Toe</p>
</div>
</div>
<nav class="nav"><a href="index.html">Home</a></nav>
</header>

<main class="arena">
<div class="game-box">
<h2>Tic Tac Toe</h2>

<div class="controls">
<div class="levels">
<button onclick="setLevel(this,'Easy')" class="active">Easy</button>
<button onclick="setLevel(this,'Medium')">Medium</button>
<button onclick="setLevel(this,'Hard')">Hard</button>
</div>

<div class="scoreboard">
<p>You: <span id="you">❌</span></p>
<p>Computer: <span id="cpu">⭕</span></p>
<p>Wins: <span id="wins">0</span></p>
<p>High Wins: <span id="high">0</span></p>
</div>
</div>

<div class="choice" id="choice">
<p style="font-family:Orbitron">Choose Your Mark</p>
<button onclick="choose('X')">❌</button>
<button onclick="choose('O')">⭕</button>
</div>

<div class="board" id="board" style="display:none"></div>

<div id="status" style="margin-top:12px;font-family:Orbitron,sans-serif;letter-spacing:2px;font-size:16px;color:#ff2fd1;"></div>
<button id="playAgain" class="reset-btn" style="display:none;margin-top:10px" onclick="start()">Next Round</button>
</div>
</main>

<style>
.choice{margin-top:18px;display:flex;gap:16px;justify-content:center}
.choice button{
padding:12px 18px;border-radius:12px;background:transparent;
border:1px solid rgba(0,255,255,.6);color:#00fff0;
font-family:Orbitron,sans-serif;font-size:22px;cursor:pointer
}
.choice button:hover{background:#00fff0;color:#05070f;box-shadow:0 0 18px rgba(0,255,255,.8)}

.board{
margin:16px auto;
display:grid;
gap:14px;
justify-content:center;
--cell:90px;
grid-template-columns:repeat(3,var(--cell));
}

.cell{
width:var(--cell);
height:var(--cell);
border-radius:16px;
background:#0b1024;
display:flex;
align-items:center;
justify-content:center;
font-size:calc(var(--cell) * 0.45);
font-family:Orbitron,sans-serif;
color:#00fff0;
cursor:pointer;
box-shadow:0 0 0 1px rgba(0,255,255,.4),0 0 22px rgba(0,255,255,.3);
transition:.2s
}
.cell.o{color:#ff5cff}
.cell:hover{transform:scale(1.05)}
.win{box-shadow:0 0 30px rgba(26,255,140,1)!important}
</style>

<script>
const game="tictactoe"
let board=[],level="Easy",over=false
let you="X",cpu="O",thinking=false
let winsCount=0

const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]]

const taunts=[
"Thinking… don’t blink.",
"Nice move… was it luck?",
"Is that your master plan?",
"Give me a second, human.",
"Hmm… interesting choice.",
"Bold. Very bold.",
"Calculating your downfall."
]

const cpuWinTaunts=[
"Too easy. Try again.",
"Arcade king stays king.",
"That board is mine.",
"You fought well. Not enough."
]

const cpuLoseTaunts=[
"No way… you got me.",
"Beginner’s luck. Rematch!",
"Okay… that was clean.",
"I’ll remember this."
]

const drawTaunts=[
"Stalemate. Respect.",
"Looks like we’re equals.",
"A draw? Interesting.",
"Call it a truce?"
]

async function loadHigh(){
const r=await fetch(`http://localhost:3000/high-score/${game}/${level}`)
const d=await r.json()
document.getElementById("high").textContent=d.high
}
loadHigh()

function setLevel(btn,l){
level=l
document.querySelectorAll(".levels button").forEach(b=>b.classList.remove("active"))
btn.classList.add("active")
winsCount=0
document.getElementById("wins").textContent=0
loadHigh()
resetAll()
}

function choose(m){
you=m
cpu=m==="X"?"O":"X"
document.getElementById("you").textContent=you==="X"?"❌":"⭕"
document.getElementById("cpu").textContent=cpu==="X"?"❌":"⭕"
document.getElementById("choice").style.display="none"
document.getElementById("board").style.display="grid"
start()
resizeBoard()
if(cpu==="X") cpuTurn()
}

function resetAll(){
document.getElementById("choice").style.display="flex"
document.getElementById("board").style.display="none"
document.getElementById("status").textContent=""
document.getElementById("playAgain").style.display="none"
thinking=false
}

function start(){
board=Array(9).fill("")
over=false
thinking=false
document.getElementById("status").textContent=""
document.getElementById("playAgain").style.display="none"
render()
resizeBoard()
}

function resizeBoard(){
const box=document.querySelector(".game-box")
const boardEl=document.getElementById("board")
const rect=box.getBoundingClientRect()
const free=Math.min(box.clientWidth, window.innerHeight-rect.top-160)
const cell=Math.max(60, Math.floor(free/3)-12)
boardEl.style.setProperty("--cell",cell+"px")
}

window.addEventListener("resize",resizeBoard)

function render(){
const b=document.getElementById("board")
b.innerHTML=""
board.forEach((v,i)=>{
const d=document.createElement("div")
d.className="cell"+(v===cpu?" o":"")
d.textContent=v==="X"?"❌":v==="O"?"⭕":""
d.onclick=()=>move(i)
b.appendChild(d)
})
}

function move(i){
if(board[i]||over||thinking) return
board[i]=you
render()
if(check(you)) return winRound(true)
if(board.every(v=>v)) return draw()
cpuTurn()
}

function cpuTurn(){
thinking=true
document.getElementById("status").textContent=taunts[Math.floor(Math.random()*taunts.length)]
const delay=900+Math.random()*500
setTimeout(()=>{
aiMove()
thinking=false
},delay)
}

function aiMove(){
if(over) return
let i
if(level==="Easy"){
i=randomMove()
}else if(level==="Medium"){
i=Math.random()<0.6 ? (smart(cpu)||smart(you)||randomMove()) : randomMove()
}else{
i = Math.random() < 0.9 ? bestMove() : randomMove()
}
board[i]=cpu
render()
if(check(cpu)) winRound(false)
else if(board.every(v=>v)) draw()
else document.getElementById("status").textContent="Your move."
}

function randomMove(){
const e=board.map((v,i)=>v===""?i:null).filter(v=>v!=null)
return e[Math.floor(Math.random()*e.length)]
}

function smart(p){
for(const w of wins){
const vals=w.map(i=>board[i])
if(vals.filter(v=>v===p).length===2 && vals.includes("")) return w[vals.indexOf("")]
}
return null
}

function bestMove(){
let bestScore=-Infinity, move=null
for(let i=0;i<9;i++){
if(board[i]===""){
board[i]=cpu
let score=minimax(board,0,false)
board[i]=""
if(score>bestScore){bestScore=score;move=i}
}
}
return move
}

function minimax(b,depth,isMax){
if(checkSim(cpu,b)) return 10-depth
if(checkSim(you,b)) return depth-10
if(b.every(v=>v)) return 0

if(isMax){
let best=-Infinity
for(let i=0;i<9;i++){
if(b[i]===""){
b[i]=cpu
best=Math.max(best,minimax(b,depth+1,false))
b[i]=""
}
}
return best
}else{
let best=Infinity
for(let i=0;i<9;i++){
if(b[i]===""){
b[i]=you
best=Math.min(best,minimax(b,depth+1,true))
b[i]=""
}
}
return best
}
}

function checkSim(p,b){
return wins.some(w=>w.every(i=>b[i]===p))
}

function check(p){
for(const w of wins){
if(w.every(i=>board[i]===p)){highlight(w);return true}
}
return false
}

function highlight(w){
const cells=[...document.querySelectorAll(".cell")]
w.forEach(i=>cells[i].classList.add("win"))
}

async function winRound(playerWon){
over=true
let msg, line
if(playerWon){
winsCount++
document.getElementById("wins").textContent=winsCount
msg="YOU WIN!"
line=cpuLoseTaunts[Math.floor(Math.random()*cpuLoseTaunts.length)]
await fetch("http://localhost:3000/save-score",{
method:"POST",
headers:{ "Content-Type":"application/json" },
body:JSON.stringify({game,level,score:winsCount})
})
loadHigh()
}else{
msg="COMPUTER WINS!"
line=cpuWinTaunts[Math.floor(Math.random()*cpuWinTaunts.length)]
}
document.getElementById("status").textContent=msg+" — "+line
document.getElementById("playAgain").style.display="inline-block"
}

function draw(){
over=true
document.getElementById("status").textContent="DRAW! — "+drawTaunts[Math.floor(Math.random()*drawTaunts.length)]
document.getElementById("playAgain").style.display="inline-block"
}

resetAll()
</script>

</body>
</html>


